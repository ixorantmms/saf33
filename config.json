Refactor codebase with Z [GwUYDh] line 1.1
Improve performance [18NQJR] line 4.2
Improve performance [18NQJR] line 4.3
